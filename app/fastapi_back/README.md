# FastAPI HTTP API и веб-интерфейс для взаимодействия с моделью tf-idf

## Структура проекта

```
fastapi_back/
├── LICENSE
├── README.md
└── src/
    ├── __init__.py
    ├── api/
    │   └── v1/
    │       ├── api_route.py  -- Основные эндпоинты для взаимодействия с моделью
    │       ├── schemas.py  -- Схемы вопросов и ответов
    │       └── tfidf_pretrained.joblib  -- Предобученная модель tf-idf
    ├── logger.py  -- Конфигурация инструмента для логирования
    ├── logs/ -- Логи
    ├── main.py -- Основной файл для запуска приложения
    ├── qdrant/
    │   └── load_qdrant.py  -- Функции для интеграции с векторной БД qdrant
    └── tests/
        ├── conftest.py  -- Конфигурация тестов
        ├── full_dataset.csv  -- Датасет для тестов
        └── test_model.py  -- Тесты
```

## Функционал

- Загрузка датасетов
- Обучение моделей (в настоящее время поддерживается TF-IDF)
- Интеграция с векторной базой данных Qdrant для эффективного поиска по схожести
- Загрузка и выгрузка моделей из оперативной памяти (TODO)
- Поиск контекста для заданных вопросов
- Тестирование качества и скорости модели
- Вывод списка загруженных наборов данных и обученных моделей
- Удаление моделей (по одной или всех сразу)

## API Endpoints

- `POST /api/v1/models/load_dataset`: Загрузить датасет
- `POST /api/v1/models/fit_save`: Обучить модель и сохранить в Qdrant
- `POST /api/v1/models/load_model`: Загрузить модель в оперативную память (TODO)
- `POST /api/v1/models/unload_model`: Выгрузить модели из оперативной памяти (TODO)
- `POST /api/v1/models/find_context`: Найти контекст для заданного вопроса
- `POST /api/v1/models/quality_test`: Оценить точность и производительность модели
- `GET /api/v1/models/get_datasets`: Получить список загруженных наборов данных
- `GET /api/v1/models/list_models`: Получить список загруженных и обученных моделей
- `DELETE /api/v1/models/remove/{model_id}`: Удалить конкретную модель
- `DELETE /api/v1/models/remove_all`: Удалить все модели

## Настройка и запуск

1. Установите зависимости (pip install -r requirements.txt)
2. Настройте `QdrantClient` в файле `src/api/v1/api_route.py`
3. Запустите FastAPI:
   ```
   uvicorn src.main:app --reload
   ```

## Тестирование

Тесты расположены в папке `src/tests/`. 

Команда для запуска:

```
pytest src/tests/
```

## Логирование

Логи хранятся в директории `src/logs/`, разделенные на отдельные файлы для API, основного приложения и операций Qdrant.

## Примечание

Этот проект является частью годового проекта. Данный README описывает лишь часть backend реализованную на fastapi
